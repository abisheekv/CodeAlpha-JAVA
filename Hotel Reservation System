import java.util.*;

enum RoomType {
    STANDARD, DELUXE, SUITE
}

class Room {
    private int roomNumber;
    private RoomType type;
    private double pricePerNight;
    private boolean available;

    public Room(int roomNumber, RoomType type, double pricePerNight) {
        this.roomNumber = roomNumber;
        this.type = type;
        this.pricePerNight = pricePerNight;
        this.available = true;
    }

    public int getRoomNumber() { return roomNumber; }
    public RoomType getType() { return type; }
    public double getPricePerNight() { return pricePerNight; }
    public boolean isAvailable() { return available; }
    public void setAvailable(boolean available) { this.available = available; }

    @Override
    public String toString() {
        return "Room " + roomNumber + " [" + type + "], Price: " +
                pricePerNight + ", Available: " + available;
    }
}

class Reservation {
    private static int nextId = 1;
    private int id;
    private String guestName;
    private Room room;
    private String checkInDate;
    private String checkOutDate;
    private double totalAmount;

    public Reservation(String guestName, Room room,
                       String checkInDate, String checkOutDate,
                       double totalAmount) {
        this.id = nextId++;
        this.guestName = guestName;
        this.room = room;
        this.checkInDate = checkInDate;
        this.checkOutDate = checkOutDate;
        this.totalAmount = totalAmount;
    }

    public int getId() { return id; }
    public String getGuestName() { return guestName; }
    public Room getRoom() { return room; }
    public String getCheckInDate() { return checkInDate; }
    public String getCheckOutDate() { return checkOutDate; }
    public double getTotalAmount() { return totalAmount; }

    @Override
    public String toString() {
        return "Reservation ID: " + id +
                ", Guest: " + guestName +
                ", Room: " + room.getRoomNumber() +
                ", Type: " + room.getType() +
                ", Check-in: " + checkInDate +
                ", Check-out: " + checkOutDate +
                ", Amount: " + totalAmount;
    }
}

class Hotel {
    private String name;
    private List<Room> rooms = new ArrayList<>();
    private List<Reservation> reservations = new ArrayList<>();

    public Hotel(String name) {
        this.name = name;
    }

    public void addRoom(Room room) {
        rooms.add(room);
    }

    public void showAvailableRoomsByType(RoomType type) {
        System.out.println("Available " + type + " rooms:");
        for (Room r : rooms) {
            if (r.getType() == type && r.isAvailable()) {
                System.out.println(r);
            }
        }
    }

    public Room findAvailableRoom(int roomNumber) {
        for (Room r : rooms) {
            if (r.getRoomNumber() == roomNumber && r.isAvailable()) {
                return r;
            }
        }
        return null;
    }

    public Reservation findReservation(int id) {
        for (Reservation r : reservations) {
            if (r.getId() == id) return r;
        }
        return null;
    }

    public Reservation makeReservation(String guestName, int roomNumber,
                                       String checkIn, String checkOut, int nights) {
        Room room = findAvailableRoom(roomNumber);
        if (room == null) return null;
        double amount = room.getPricePerNight() * nights; // simple pricing
        if (!simulatePayment(guestName, amount)) return null;
        room.setAvailable(false);
        Reservation res = new Reservation(guestName, room, checkIn, checkOut, amount);
        reservations.add(res);
        return res;
    }

    public boolean cancelReservation(int id) {
        Reservation r = findReservation(id);
        if (r == null) return false;
        r.getRoom().setAvailable(true);
        reservations.remove(r);
        return true;
    }

    public void viewAllReservations() {
        if (reservations.isEmpty()) {
            System.out.println("No reservations yet.");
            return;
        }
        for (Reservation r : reservations) {
            System.out.println(r);
        }
    }

    // very simple payment simulation
    private boolean simulatePayment(String guestName, double amount) {
        Scanner sc = new Scanner(System.in);
        System.out.println("Payment for " + guestName + ": " + amount);
        System.out.print("Enter 1 to confirm payment, 0 to cancel: ");
        int choice = sc.nextInt();
        return choice == 1;
    }

    public String getName() { return name; }
}

public class HotelReservationApp {
    private static Scanner sc = new Scanner(System.in);

    public static void main(String[] args) {
        Hotel hotel = new Hotel("Demo Hotel");

        // sample rooms (Standard, Deluxe, Suite)
        hotel.addRoom(new Room(101, RoomType.STANDARD, 2000));
        hotel.addRoom(new Room(102, RoomType.STANDARD, 2200));
        hotel.addRoom(new Room(201, RoomType.DELUXE, 3500));
        hotel.addRoom(new Room(301, RoomType.SUITE, 5000));

        while (true) {
            System.out.println("\n=== " + hotel.getName() + " Reservation System ===");
            System.out.println("1. Search rooms");
            System.out.println("2. Make reservation");
            System.out.println("3. Cancel reservation");
            System.out.println("4. View bookings");
            System.out.println("5. Exit");
            System.out.print("Choose option: ");

            int choice = readInt();

            switch (choice) {
                case 1:
                    searchRooms(hotel);
                    break;
                case 2:
                    makeReservationFlow(hotel);
                    break;
                case 3:
                    cancelReservationFlow(hotel);
                    break;
                case 4:
                    hotel.viewAllReservations();
                    break;
                case 5:
                    System.out.println("Goodbye.");
                    return;
                default:
                    System.out.println("Invalid option.");
            }
        }
    }

    private static void searchRooms(Hotel hotel) {
        RoomType type = readRoomType();
        hotel.showAvailableRoomsByType(type);
    }

    private static void makeReservationFlow(Hotel hotel) {
        System.out.print("Guest name: ");
        String guest = sc.nextLine();

        RoomType type = readRoomType();
        hotel.showAvailableRoomsByType(type);

        System.out.print("Enter room number to book: ");
        int roomNo = readInt();

        System.out.print("Check-in date (dd-mm-yyyy): ");
        String checkIn = sc.nextLine();
        System.out.print("Check-out date (dd-mm-yyyy): ");
        String checkOut = sc.nextLine();
        System.out.print("Number of nights: ");
        int nights = readInt();

        Reservation res = hotel.makeReservation(guest, roomNo, checkIn, checkOut, nights);
        if (res == null) {
            System.out.println("Booking failed (room not available or payment cancelled).");
        } else {
            System.out.println("Booking successful!");
            System.out.println(res);
        }
    }

    private static void cancelReservationFlow(Hotel hotel) {
        System.out.print("Enter reservation ID to cancel: ");
        int id = readInt();
        if (hotel.cancelReservation(id)) {
            System.out.println("Reservation cancelled.");
        } else {
            System.out.println("Reservation not found.");
        }
    }

    private static RoomType readRoomType() {
        System.out.println("Select room type: 1.Standard  2.Deluxe  3.Suite");
        int t = readInt();
        switch (t) {
            case 1: return RoomType.STANDARD;
            case 2: return RoomType.DELUXE;
            case 3: return RoomType.SUITE;
            default:
                System.out.println("Invalid, defaulting to STANDARD.");
                return RoomType.STANDARD;
        }
    }

    private static int readInt() {
        while (!sc.hasNextInt()) {
            System.out.print("Enter a valid number: ");
            sc.next();
        }
        int val = sc.nextInt();
        sc.nextLine(); // clear newline
        return val;
    }
}
